# guard value for offsetmcr must be in milliseconds
# period 0 means task is of type old

transitions:
  # 0 -> 1   MODE_NONE -> MODE_INIT
  - trans_id: 0
    source_mode: 0
    dest_mode: 1
    taskset:
      - task_id: 0 # changed
        parameters:
          period: 200
          priority: 10
        primitives:
          action: "ACTION_UPDATE"
          guard: "GUARD_TRUE"
          guard_value: -1
      - task_id: 1 # new
        parameters:
          period: 500
          priority: 10
        primitives:
          action: "ACTION_RELEASE"
          guard: "GUARD_OFFSETMCR"
          guard_value: 3000

  # 1 -> 0   MODE_INIT -> MODE_NONE
  - trans_id: 1
    source_mode: 1
    dest_mode: 0
    taskset:
      - task_id: 0 # changed
        parameters:
          period: 100
          priority: 10
        # when does it get updated? after it finishes its execution? let it finish or change parameters while executing? does it matter?
        primitives:
          action: "ACTION_UPDATE"
          guard: "GUARD_TRUE"
          guard_value: -1
      - task_id: 1 # old
        parameters:
          period: 0
          priority: 10
        # if task gets suspended mid execution, when it comes back it resumes at that point in execution and other problems may happen. must find a way to suspend after task finishes.
        # I can check if it's blocked because it may have called vtaskdelay(), but many other things can block it...
        primitives: 
          action: "ACTION_SUSPEND"
          guard: "GUARD_TRUE"
          guard_value: -1

# if the guard is not none, guard value must not be -1

tasks:
  - id: 0
    name: "taskZero"
    func: "taskZero_utask"
  - id: 1
    name: "taskOne"
    func: "taskOne_utask"


modes:
  - id: 0
    name: "MODE_NONE"
  - id: 1
    name: "MODE_INIT"
  - id: 2
    name: "MODE_EMERGENCY"
